
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Fitting curves to real data &#8212; neutcurve 0.2.4 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Raw data from plate reader" href="raw_examples.html" />
    <link rel="prev" title="Hill-curve neutralization" href="hillcurve_example.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fitting-curves-to-real-data">
<span id="curvefits-example"></span><h1>Fitting curves to real data<a class="headerlink" href="#fitting-curves-to-real-data" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id1">Overview</a></p></li>
<li><p><a class="reference internal" href="#importing-python-packages" id="id2">Importing Python packages</a></p></li>
<li><p><a class="reference internal" href="#preparing-the-data" id="id3">Preparing the data</a></p></li>
<li><p><a class="reference internal" href="#fitting-the-curves" id="id4">Fitting the curves</a></p></li>
<li><p><a class="reference internal" href="#looking-at-a-specific-curve" id="id5">Looking at a specific curve</a></p></li>
<li><p><a class="reference internal" href="#accessing-the-fit-parameters-for-all-curves" id="id6">Accessing the fit parameters for all curves</a></p></li>
<li><p><a class="reference internal" href="#plotting-the-curves" id="id7">Plotting the curves</a></p>
<ul>
<li><p><a class="reference internal" href="#plotting-each-serum-against-multiple-viruses" id="id8">Plotting each serum against multiple viruses</a></p></li>
<li><p><a class="reference internal" href="#plotting-each-replicate" id="id9">Plotting each replicate</a></p></li>
<li><p><a class="reference internal" href="#plotting-average-for-each-serum-virus-pair" id="id10">Plotting average for each serum-virus pair</a></p></li>
<li><p><a class="reference internal" href="#customized-plot-arrangements" id="id11">Customized plot arrangements</a></p></li>
</ul>
</li>
</ul>
</div>
<a class="reference download internal" href="curvefits_example_full.ipynb">Download this page as a Jupyter notebook (with outputs)</a><div class="section" id="overview">
<h2><a class="toc-backref" href="#id1">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>When you have a real dataset, the easiest way to fit it is via the
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits" title="neutcurve.curvefits.CurveFits"><code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code></a> class, which
streamlines the fitting and plotting of a set of
<a class="reference internal" href="neutcurve.hillcurve.html#neutcurve.hillcurve.HillCurve" title="neutcurve.hillcurve.HillCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code></a> neutralization curves.
Here we demonstrate how to do this.</p>
</div>
<div class="section" id="importing-python-packages">
<h2><a class="toc-backref" href="#id2">Importing Python packages</a><a class="headerlink" href="#importing-python-packages" title="Permalink to this headline">¶</a></h2>
<p>First, import the necessary Python modules. In addition to the
<code class="docutils literal notranslate"><span class="pre">neutcurve</span></code> package itself, we also use
<a class="reference external" href="https://pandas.pydata.org/">pandas</a> to hold the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">neutcurve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutcurve.colorschemes</span> <span class="k">import</span> <span class="n">CBMARKERS</span><span class="p">,</span> <span class="n">CBPALETTE</span>
</pre></div>
</div>
<p>Set some pandas display options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="preparing-the-data">
<h2><a class="toc-backref" href="#id3">Preparing the data</a><a class="headerlink" href="#preparing-the-data" title="Permalink to this headline">¶</a></h2>
<p>Now we get example data to fit. We use as our example the neutralization
of variants A/WSN/1933 (H1N1) influenza by the broadly neutralizing
antibody FI6v3 and strain-specific antibody H17-L19 from <a class="reference external" href="https://www.nature.com/articles/s41467-018-03665-3#Fig6">Fig 6a,b of
Doud et al
(2018)</a>.
These data in numerical form in a CSV file are available in the CSV file
<a class="reference download internal" download="" href="_downloads/6d9ae1cdf4cf6322167a78fc658f02d7/Doud_et_al_2018-neutdata.csv"><code class="xref download docutils literal notranslate"><span class="pre">example_data/Doud_et_al_2018-neutdata.csv</span></code></a>
We start by downloading these data and reading them into a pandas
DataFrame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fi6v3_datafile</span> <span class="o">=</span> <span class="s1">&#39;example_data/Doud_et_al_2018-neutdata.csv&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fi6v3_datafile</span><span class="p">)</span>
</pre></div>
</div>
<p>Here are the first few lines of the data frame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">   serum virus  replicate  concentration  fraction infectivity</span>
<span class="go">0  FI6v3    WT          1       0.000205                  1.01</span>
<span class="go">1  FI6v3    WT          1       0.000478                 0.942</span>
<span class="go">2  FI6v3    WT          1        0.00112                 0.993</span>
<span class="go">3  FI6v3    WT          1         0.0026                 0.966</span>
<span class="go">4  FI6v3    WT          1        0.00607                 0.957</span>
</pre></div>
</div>
<p>And here are the last few lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
<span class="go">       serum  virus  replicate  concentration  fraction infectivity</span>
<span class="go">427  H17-L19  V135T          3          0.386                  1.02</span>
<span class="go">428  H17-L19  V135T          3            0.9                     1</span>
<span class="go">429  H17-L19  V135T          3            2.1                 0.959</span>
<span class="go">430  H17-L19  V135T          3            4.9                 0.991</span>
<span class="go">431  H17-L19  V135T          3           11.4                 0.747</span>
</pre></div>
</div>
<p>As can be seen above, the data are organized into five columns, all of
which must be present. These columns are:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>serum</em>: the name of the
serum (or antibody). FI6v3 and H17-L19 are actually antibodies, not
sera, but <a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits" title="neutcurve.curvefits.CurveFits"><code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code></a> is set up to refer to
things as serum.</p></li>
<li><p><em>virus</em>: the name of the virus being neutralized by
the serum.</p></li>
<li><p><em>replicate</em>: the replicate label for the measurement.
Although you can have just one replicate, it’s good experimental
practice to have several. All the replicates for a given virus / serum
combination must have been measured at the same concentrations.</p></li>
<li><p><em>concentration</em>: the concentration of the serum.</p></li>
<li><p><em>fraction infectivity</em>: the fraction infectivity of the virus at this
concentration of the serum measured in this replicate.</p></li>
</ul>
</div></blockquote>
<p>Note that the data are in <a class="reference external" href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">tidy form</a>;
you must make your data frame tidy before you can analyze it with
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits" title="neutcurve.curvefits.CurveFits"><code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code></a>.</p>
</div>
<div class="section" id="fitting-the-curves">
<h2><a class="toc-backref" href="#id4">Fitting the curves</a><a class="headerlink" href="#fitting-the-curves" title="Permalink to this headline">¶</a></h2>
<p>Once you have the tidy data frame, it’s easy to pass it to
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits" title="neutcurve.curvefits.CurveFits"><code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code></a>. We expect all of these
antibodies to go to complete neutralization when they are effective, so
we use default values of <cite>fixtop=1</cite> and <cite>fixbottom=0</cite> argument (see
<code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurves</span></code> and <a class="reference internal" href="hillcurve_example.html#hillcurve-example"><span class="std std-ref">Hill-curve neutralization</span></a> for more details about the
<cite>fixtop</cite> and <cite>fixbottom</cite> options):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span> <span class="o">=</span> <span class="n">neutcurve</span><span class="o">.</span><span class="n">CurveFits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can look at the different sera for which we have fit curves:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">sera</span>
<span class="go">[&#39;FI6v3&#39;, &#39;H17-L19&#39;]</span>
</pre></div>
</div>
<p>We can also look at the viruses measured against each serum:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">serum</span> <span class="ow">in</span> <span class="n">fits</span><span class="o">.</span><span class="n">sera</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Viruses measured against </span><span class="si">{serum}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
<span class="gp">... </span>          <span class="nb">str</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">viruses</span><span class="p">[</span><span class="n">serum</span><span class="p">]))</span>
<span class="go">Viruses measured against FI6v3:</span>
<span class="go">[&#39;WT&#39;, &#39;K(-8T)&#39;, &#39;P80D&#39;, &#39;V135T&#39;, &#39;K280A&#39;, &#39;K280S&#39;, &#39;K280T&#39;, &#39;N291S&#39;, &#39;M17L-HA2&#39;, &#39;G47R-HA2&#39;]</span>
<span class="go">Viruses measured against H17-L19:</span>
<span class="go">[&#39;WT&#39;, &#39;V135T&#39;]</span>
</pre></div>
</div>
<p>We can also look at the replicates for each serum and virus. Here we
just do that for serum <em>FI6v3</em> and virus <em>WT</em>. See how in addition to
the three replicates we have passed, there is also now an “average”
replicate that is automatically computed from the average of the other
replicates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">replicates</span><span class="p">[(</span><span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;WT&#39;</span><span class="p">)]</span>
<span class="go">[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;average&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="looking-at-a-specific-curve">
<h2><a class="toc-backref" href="#id5">Looking at a specific curve</a><a class="headerlink" href="#looking-at-a-specific-curve" title="Permalink to this headline">¶</a></h2>
<p>We can use the <a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.getCurve" title="neutcurve.curvefits.CurveFits.getCurve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.getCurve()</span></code></a> method
to get the <a class="reference internal" href="neutcurve.hillcurve.html#neutcurve.hillcurve.HillCurve" title="neutcurve.hillcurve.HillCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code></a> that was fit for a
particular serum / virus / replicate combination. For instance, here we
do that for <em>serum</em> FI6v3 versus <em>virus</em> WT for replicate <em>1</em>. We then
plot the curve and print the IC50:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">curve</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getCurve</span><span class="p">(</span><span class="n">serum</span><span class="o">=</span><span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="n">virus</span><span class="o">=</span><span class="s1">&#39;WT&#39;</span><span class="p">,</span> <span class="n">replicate</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The IC50 is {curve.ic50():.3g}&quot;</span><span class="p">)</span>
<span class="go">The IC50 is 0.0167</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-12.png">png</a>, <a class="reference external" href=".//curvefits_example-12.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-12.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-12.png" src="_images/curvefits_example-12.png" />
</div>
<p><a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits" title="neutcurve.curvefits.CurveFits"><code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code></a> also calculates the average and
standard error of the measurements for each serum / virus, and fits them
under a replicate name of “average”. Here is the fit to the average of
the data for <em>serum</em> FI6v3 and <em>virus</em> WT. Note how the plot now also
shows error bars indicating the standard error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">curve</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getCurve</span><span class="p">(</span><span class="n">serum</span><span class="o">=</span><span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="n">virus</span><span class="o">=</span><span class="s1">&#39;WT&#39;</span><span class="p">,</span> <span class="n">replicate</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;The IC50 is {curve.ic50():.3g}&quot;</span><span class="p">)</span>
<span class="go">The IC50 is 0.017</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-13.png">png</a>, <a class="reference external" href=".//curvefits_example-13.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-13.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-13.png" src="_images/curvefits_example-13.png" />
</div>
</div>
<div class="section" id="accessing-the-fit-parameters-for-all-curves">
<h2><a class="toc-backref" href="#id6">Accessing the fit parameters for all curves</a><a class="headerlink" href="#accessing-the-fit-parameters-for-all-curves" title="Permalink to this headline">¶</a></h2>
<p>You can get the fit parameters for the curves using
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.fitParams" title="neutcurve.curvefits.CurveFits.fitParams"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.fitParams()</span></code></a>. By default, this just
gets the fits for the average of the replicates. The parameters are all
of those fit by a <a class="reference internal" href="neutcurve.hillcurve.html#neutcurve.hillcurve.HillCurve" title="neutcurve.hillcurve.HillCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code></a>, plus the
IC50 in several forms to accurately represent interpolated IC50s (IC50
within range of data) versus IC50s where we can just get the bound from
the upper or lower limits of the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">()</span>
<span class="go">      serum     virus replicate  nreplicates   ic50    ic50_bound ic50_str  midpoint  slope  top  bottom</span>
<span class="go">0     FI6v3        WT   average            3  0.017  interpolated    0.017     0.017   2.28    1       0</span>
<span class="go">1     FI6v3    K(-8T)   average            3 0.0283  interpolated   0.0283    0.0283    2.4    1       0</span>
<span class="go">2     FI6v3      P80D   average            3 0.0123  interpolated   0.0123    0.0123   2.05    1       0</span>
<span class="go">3     FI6v3     V135T   average            3 0.0229  interpolated   0.0229    0.0229   1.83    1       0</span>
<span class="go">4     FI6v3     K280A   average            3 0.0106  interpolated   0.0106    0.0106   1.86    1       0</span>
<span class="go">5     FI6v3     K280S   average            3 0.0428  interpolated   0.0428    0.0428      2    1       0</span>
<span class="go">6     FI6v3     K280T   average            3 0.0348  interpolated   0.0348    0.0348   1.82    1       0</span>
<span class="go">7     FI6v3     N291S   average            3 0.0845  interpolated   0.0845    0.0845    1.8    1       0</span>
<span class="go">8     FI6v3  M17L-HA2   average            3 0.0198  interpolated   0.0198    0.0198   2.06    1       0</span>
<span class="go">9     FI6v3  G47R-HA2   average            3 0.0348  interpolated   0.0348    0.0348    2.6    1       0</span>
<span class="go">10  H17-L19        WT   average            3  0.107  interpolated    0.107     0.107   3.94    1       0</span>
<span class="go">11  H17-L19     V135T   average            3   11.4         lower    &gt;11.4      15.5   2.76    1       0</span>
</pre></div>
</div>
<p>Looking above, you can see how the IC50 is handled depending on if it is
interpolated (in the range of concentrations used in the experiments)
versus outside the range of concentrations. In the table above, all of
the IC50s are interpolated <strong>except</strong> the last row (H17-L19 versus
V135T), which is just provided as an upper bound equal to the highest
concentration used in the experiment (the actual IC50 is greater than
this upper bound). We do <strong>not</strong> attempt to extrapolate IC50s outside
the data range as this is unreliable.</p>
<p>Note that by default, <a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.fitParams" title="neutcurve.curvefits.CurveFits.fitParams"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.fitParams()</span></code></a>
only returns the fitted params for the averages, as in the above table.
If you want to also return them for individual replicates, using the
<cite>average_only=False</cite> argument. Here we do this, showing only the first
few entries in the returned data frame; now there are now values for
each replicate as well as the average of replicates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">(</span><span class="n">average_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">   serum   virus replicate  nreplicates   ic50    ic50_bound ic50_str  midpoint  slope  top  bottom</span>
<span class="go">0  FI6v3      WT         1          NaN 0.0167  interpolated   0.0167    0.0167    2.5    1       0</span>
<span class="go">1  FI6v3      WT         2          NaN  0.019  interpolated    0.019     0.019   2.51    1       0</span>
<span class="go">2  FI6v3      WT         3          NaN 0.0152  interpolated   0.0152    0.0152   1.88    1       0</span>
<span class="go">3  FI6v3      WT   average            3  0.017  interpolated    0.017     0.017   2.28    1       0</span>
<span class="go">4  FI6v3  K(-8T)         1          NaN 0.0308  interpolated   0.0308    0.0308   2.62    1       0</span>
</pre></div>
</div>
<p>The “average” is the curve fit to the average of the data
points, not the average of the fit parameters for individual curves.</p>
<p>We can also include arbitrary inhibitory concentrations, such as the IC95 in
addition to the IC50 via the <cite>ics</cite> argument to
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.fitParams" title="neutcurve.curvefits.CurveFits.fitParams"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.fitParams()</span></code></a>.
For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">(</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">95</span><span class="p">])</span>
<span class="go">      serum     virus replicate  nreplicates   ic50    ic50_bound ic50_str   ic95    ic95_bound ic95_str  midpoint  slope  top  bottom</span>
<span class="go">0     FI6v3        WT   average            3  0.017  interpolated    0.017  0.062  interpolated    0.062     0.017   2.28    1       0</span>
<span class="go">1     FI6v3    K(-8T)   average            3 0.0283  interpolated   0.0283 0.0967  interpolated   0.0967    0.0283    2.4    1       0</span>
<span class="go">2     FI6v3      P80D   average            3 0.0123  interpolated   0.0123 0.0516  interpolated   0.0516    0.0123   2.05    1       0</span>
<span class="go">3     FI6v3     V135T   average            3 0.0229  interpolated   0.0229  0.114  interpolated    0.114    0.0229   1.83    1       0</span>
<span class="go">4     FI6v3     K280A   average            3 0.0106  interpolated   0.0106 0.0516  interpolated   0.0516    0.0106   1.86    1       0</span>
<span class="go">5     FI6v3     K280S   average            3 0.0428  interpolated   0.0428  0.186  interpolated    0.186    0.0428      2    1       0</span>
<span class="go">6     FI6v3     K280T   average            3 0.0348  interpolated   0.0348  0.176  interpolated    0.176    0.0348   1.82    1       0</span>
<span class="go">7     FI6v3     N291S   average            3 0.0845  interpolated   0.0845  0.433  interpolated    0.433    0.0845    1.8    1       0</span>
<span class="go">8     FI6v3  M17L-HA2   average            3 0.0198  interpolated   0.0198  0.083  interpolated    0.083    0.0198   2.06    1       0</span>
<span class="go">9     FI6v3  G47R-HA2   average            3 0.0348  interpolated   0.0348  0.108  interpolated    0.108    0.0348    2.6    1       0</span>
<span class="go">10  H17-L19        WT   average            3  0.107  interpolated    0.107  0.227  interpolated    0.227     0.107   3.94    1       0</span>
<span class="go">11  H17-L19     V135T   average            3   11.4         lower    &gt;11.4   11.4         lower    &gt;11.4      15.5   2.76    1       0</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-the-curves">
<h2><a class="toc-backref" href="#id7">Plotting the curves</a><a class="headerlink" href="#plotting-the-curves" title="Permalink to this headline">¶</a></h2>
<p>One of the most useful feature of
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits" title="neutcurve.curvefits.CurveFits"><code class="xref py py-class docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code></a> are that they have methods to
easily generate multi-panel plots of the curves.</p>
<div class="section" id="plotting-each-serum-against-multiple-viruses">
<h3><a class="toc-backref" href="#id8">Plotting each serum against multiple viruses</a><a class="headerlink" href="#plotting-each-serum-against-multiple-viruses" title="Permalink to this headline">¶</a></h3>
<p>Often you will have measured each serum against several different viral
variants. You can then plot these curves using
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.plotSera" title="neutcurve.curvefits.CurveFits.plotSera"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotSera()</span></code></a> as below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;concentration (ug/ml)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-17.png">png</a>, <a class="reference external" href=".//curvefits_example-17.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-17.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-17.png" src="_images/curvefits_example-17.png" />
</div>
<p>The above plot attempts to put all the viruses measured against each
serum on the same subplot, but is cognizant of the fact that it becomes
uninterpretable if there are too many viruses on the same plot.
Therefore, it only shows a maximum of <cite>max_viruses_per_subplot</cite> (which
by default is 5) curves per subplot.</p>
<p>In fact, that is still perhaps too many curves per plot for this data set. So we can
customize the plot by adjusting that parameter. Below we adjust to just
four viruses per subplot, and also use <cite>ncol=2</cite> to specify that we
want two columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span><span class="n">max_viruses_per_subplot</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;concentration (ug/ml)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-18.png">png</a>, <a class="reference external" href=".//curvefits_example-18.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-18.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-18.png" src="_images/curvefits_example-18.png" />
</div>
<p>The above plots all have a different legend for each subplot. This is
necessary because the number of different viruses being plotted exceeds
the numbers of colors / markers specified to
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.plotSera" title="neutcurve.curvefits.CurveFits.plotSera"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotSera()</span></code></a> via its <cite>colors</cite> and
<cite>markers</cite> arguments, so there aren’t enough colors / markers to give
each virus a unique one.</p>
<p>However, if we reduce the number of viruses we are showing, we then get
a nice shared legend. Here we do this, using the <cite>viruses</cite> argument to
specify that we just show some of the viruses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span><span class="n">viruses</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;WT&#39;</span><span class="p">,</span> <span class="s1">&#39;N291S&#39;</span><span class="p">,</span> <span class="s1">&#39;K280S&#39;</span><span class="p">,</span> <span class="s1">&#39;V135T&#39;</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;concentration (ug/ml)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-19.png">png</a>, <a class="reference external" href=".//curvefits_example-19.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-19.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-19.png" src="_images/curvefits_example-19.png" />
</div>
<p>Similar to how the above plot uses the <cite>viruses</cite> argument to plot just
some viruses, we can also use the <cite>sera</cite> argument to plot just some of
the sera (in this case, just H17-L19):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span><span class="n">sera</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H17-L19&#39;</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;concentration (ug/ml)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-20.png">png</a>, <a class="reference external" href=".//curvefits_example-20.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-20.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-20.png" src="_images/curvefits_example-20.png" />
</div>
<p>We can also use the <cite>virus_to_color_marker</cite> argument to specify a particular
color scheme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span><span class="n">viruses</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;WT&#39;</span><span class="p">,</span> <span class="s1">&#39;N291S&#39;</span><span class="p">,</span> <span class="s1">&#39;K280S&#39;</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;concentration (ug/ml)&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">virus_to_color_marker</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>                              <span class="s1">&#39;WT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">),</span>
<span class="gp">... </span>                              <span class="s1">&#39;N291S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">),</span>
<span class="gp">... </span>                              <span class="s1">&#39;K280S&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)},</span>
<span class="gp">... </span>                          <span class="n">legendfontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-21.png">png</a>, <a class="reference external" href=".//curvefits_example-21.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-21.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-21.png" src="_images/curvefits_example-21.png" />
</div>
<p>There are various additional options to
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.plotSera" title="neutcurve.curvefits.CurveFits.plotSera"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotSera()</span></code></a> that can further
fine-tune the plots; see the docstring for that method for more details.</p>
</div>
<div class="section" id="plotting-each-replicate">
<h3><a class="toc-backref" href="#id9">Plotting each replicate</a><a class="headerlink" href="#plotting-each-replicate" title="Permalink to this headline">¶</a></h3>
<p>Another type of plot that is sometimes useful is one that shows all the
replicates for each serum / virus combination. Such a plot is easily
generated using <a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.plotReplicates" title="neutcurve.curvefits.CurveFits.plotReplicates"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotReplicates()</span></code></a>
as below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotReplicates</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;concentration (ug/ml)&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">legendtitle</span><span class="o">=</span><span class="s1">&#39;replicate&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-22.png">png</a>, <a class="reference external" href=".//curvefits_example-22.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-22.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-22.png" src="_images/curvefits_example-22.png" />
</div>
<p>See the method docstring for
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.plotReplicates" title="neutcurve.curvefits.CurveFits.plotReplicates"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotReplicates()</span></code></a> for ways to
further customize these plots.</p>
</div>
<div class="section" id="plotting-average-for-each-serum-virus-pair">
<h3><a class="toc-backref" href="#id10">Plotting average for each serum-virus pair</a><a class="headerlink" href="#plotting-average-for-each-serum-virus-pair" title="Permalink to this headline">¶</a></h3>
<p>Another type of plot that is useful is one that simply shows the
replicate-average for each serum-virus pair on its own subplot. This plot can
be generated with
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.plotAverages" title="neutcurve.curvefits.CurveFits.plotAverages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotAverages()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotAverages</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;concentration (ug/ml)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-23.png">png</a>, <a class="reference external" href=".//curvefits_example-23.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-23.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-23.png" src="_images/curvefits_example-23.png" />
</div>
</div>
<div class="section" id="customized-plot-arrangements">
<h3><a class="toc-backref" href="#id11">Customized plot arrangements</a><a class="headerlink" href="#customized-plot-arrangements" title="Permalink to this headline">¶</a></h3>
<p>There are obviously many other ways that it’s possible to lay out the
different curves for sera / viruses / replicates on subplots. You can
make an arbitrarily customized layout using
<a class="reference internal" href="neutcurve.curvefits.html#neutcurve.curvefits.CurveFits.plotGrid" title="neutcurve.curvefits.CurveFits.plotGrid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotGrid()</span></code></a> where you explicitly
pass the curves to put at each subplot in the plot.</p>
<p>Below we illustrate how to do this to create a plot that essentially
mimics what is shown in <a class="reference external" href="https://www.nature.com/articles/s41467-018-03665-3#Fig6">Fig 6a,b of Doud et al
(2018)</a>
(although those published plots were not generated using this program).
Note that in doing this below, we use the colors and markers defined by
<cite>CBPALETTE</cite> and <cite>CBMARKERS</cite> in <a class="reference internal" href="neutcurve.colorschemes.html#module-neutcurve.colorschemes" title="neutcurve.colorschemes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neutcurve.colorschemes</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">(</span>
<span class="gp">... </span>                <span class="p">{</span>
<span class="gp">... </span>                 <span class="c1"># upper right: FI6v3 versus WT, K280S, K280T, K280A</span>
<span class="gp">... </span>                 <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="p">[{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;WT&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;K280S&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;K280S&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;K280T&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;K280T&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;K280A&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;K280A&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">]</span>
<span class="gp">... </span>                          <span class="p">),</span>
<span class="gp">... </span>                 <span class="c1"># upper center: FI6v3 versus WT, N291S</span>
<span class="gp">... </span>                 <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="p">[{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;N291S&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;N291S&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">]</span>
<span class="gp">... </span>                          <span class="p">),</span>
<span class="gp">... </span>                 <span class="c1"># upper right: FI6v3 versus WT, G47R-HA2</span>
<span class="gp">... </span>                 <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="p">[{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;G47R-HA2&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;G47R(HA2)&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">]</span>
<span class="gp">... </span>                          <span class="p">),</span>
<span class="gp">... </span>                 <span class="c1"># middle right: FI6v3 versus WT, K(-8T)</span>
<span class="gp">... </span>                 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="p">[{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;K(-8T)&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;K(-8T)&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">]</span>
<span class="gp">... </span>                          <span class="p">),</span>
<span class="gp">... </span>                 <span class="c1"># middle center: FI6v3 versus WT, M17L-HA2</span>
<span class="gp">... </span>                 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="p">[{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;M17L-HA2&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;M17L(HA2)&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">]</span>
<span class="gp">... </span>                          <span class="p">),</span>
<span class="gp">... </span>                 <span class="c1"># middle right: FI6v3 versus WT, P80D, V135T</span>
<span class="gp">... </span>                 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="p">[{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;P80D&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;P80D&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;FI6v3&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;V135T&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;V135T&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">]</span>
<span class="gp">... </span>                          <span class="p">),</span>
<span class="gp">... </span>                 <span class="c1"># middle left: H17-L19 versus WT, V135T</span>
<span class="gp">... </span>                 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;H17-L19&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="p">[{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;H17-L19&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;WT&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">{</span><span class="s1">&#39;serum&#39;</span><span class="p">:</span> <span class="s1">&#39;H17-L19&#39;</span><span class="p">,</span> <span class="s1">&#39;virus&#39;</span><span class="p">:</span> <span class="s1">&#39;V135T&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="s1">&#39;replicate&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;V135T&#39;</span><span class="p">},</span>
<span class="gp">... </span>                           <span class="p">]</span>
<span class="gp">... </span>                          <span class="p">),</span>
<span class="gp">... </span>                 <span class="p">},</span>
<span class="gp">... </span>                <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;concentration (ug/ml)&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//curvefits_example-24.png">png</a>, <a class="reference external" href=".//curvefits_example-24.hires.png">hires.png</a>, <a class="reference external" href=".//curvefits_example-24.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/curvefits_example-24.png" src="_images/curvefits_example-24.png" />
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo"/>
    
    <h1 class="logo logo-name">neutcurve</h1>
    
  </a>
</p>



<p class="blurb">Fit and plot neutralization curves</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=neutcurve&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a href="https://travis-ci.org/jbloomlab/neutcurve">
    <img
        alt="https://secure.travis-ci.org/jbloomlab/neutcurve.svg?branch=master"
        src="https://secure.travis-ci.org/jbloomlab/neutcurve.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">neutcurve documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hillcurve_example.html">Hill-curve neutralization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fitting curves to real data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#importing-python-packages">Importing Python packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparing-the-data">Preparing the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fitting-the-curves">Fitting the curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#looking-at-a-specific-curve">Looking at a specific curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-the-fit-parameters-for-all-curves">Accessing the fit parameters for all curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotting-the-curves">Plotting the curves</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="raw_examples.html">Raw data from plate reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="neutcurve.html">neutcurve package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="hillcurve_example.html" title="previous chapter">Hill-curve neutralization</a></li>
      <li>Next: <a href="raw_examples.html" title="next chapter">Raw data from plate reader</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019--2019, Bloom lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/curvefits_example.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/neutcurve" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>